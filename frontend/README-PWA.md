# PWA setup notes

This app uses `vite-plugin-pwa` with the InjectManifest strategy and a custom service worker in `src/sw.ts`.

Whatâ€™s included:
- Service worker with precache, runtime caching, and push handlers
- Manual registration via workbox-window (`src/pwa.ts`)
- Install prompt capture and helper to trigger install
- Manifest generated by VitePWA with basic icons

Dev tips:
- During `vite dev`, a development service worker is enabled. Clear SWs via browser DevTools if needed.
- The SW auto-updates on new builds; you can choose to prompt users to reload on update.

Push notes:
- `src/utils/push.ts` provides helpers to request Notification permission, subscribe with a VAPID public key, and POST the subscription to your backend.
- You must implement `/api/push/subscribe` on the backend (either Python or Node) and send Web Push messages server-side.
- Add `VITE_VAPID_PUBLIC_KEY` to your environment and pass it to `subscribeUserToPush`.
 - If you omit `VITE_VAPID_PUBLIC_KEY`, the client will fetch it from `GET /api/push/public-key` (served by the python API).

Example `frontend/.env`:

```
VITE_VAPID_PUBLIC_KEY=BAbC...
```

Example subscription code:

```ts
import { subscribeUserToPush, registerSubscriptionOnServer } from './src/utils/push';

const sub = await subscribeUserToPush(import.meta.env.VITE_VAPID_PUBLIC_KEY);
if (sub) {
	await registerSubscriptionOnServer(sub);
}
```

Icons:
- Currently `public/pwa-192x192.png` is used for both 192 and 512 sizes. Add a proper `public/pwa-512x512.png` when available.

